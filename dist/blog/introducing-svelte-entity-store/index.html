<html lang="en"><head><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "url": "/blog/introducing-svelte-entity-store",
  "datePublished": "Sat May 01 2021",
  "headline": "Introducing svelte-entity-store",
  "publisher": {
    "@type": "Organization",
    "@id": "https://navillus.dev/#organization",
    "url": "https://navillus.dev/",
    "name": "Navillus",
    "description": "We specialize in finding simple solutions to complex software problems. We value data-driven decisions and accessibility over this month's latest tech trends.",
    "sameAs": [
      "https://twitter.com/navillus_dev"
    ],
    "logo": "https://navillus.dev/favicon.svg"
  },
  "dateModified": "Sat Jun 05 2021",
  "image": "https://navillus.dev/posts/2021-05-01-introducing-svelte-entity-store.jpg",
  "author": {
    "@type": "Person",
    "name": "Tony Sullivan"
  }
}</script>
<link rel="stylesheet" type="text/css" href="/_astro/common-Z1tFJFc.css">



<title>Introducing svelte-entity-store • Navillus</title><meta name="description" content="A (work-in-progress) generic entity store for Svelte projects."><meta name="keywords" content="web development, consulting, jamstack, serverless, static site, netlify, svelte, software, engineering, software engineering, api development"><meta name="robots" content="index,follow"><meta name="author" content="Navillus"><link rel="canonical" href="https://navillus.dev/blog/introducing-svelte-entity-store/"><meta property="og:title" content="Introducing svelte-entity-store"><meta property="og:site_name" content="Introducing svelte-entity-store"><meta property="og:type" content="website"><meta property="og:description" content="A (work-in-progress) generic entity store for Svelte projects."><meta property="og:image" content="https://navillus.dev/assets/share.png"><meta property="og:url" content="https://navillus.dev/blog/introducing-svelte-entity-store/"><meta name="twitter:title" content="Introducing svelte-entity-store"><meta name="twitter:description" content="A (work-in-progress) generic entity store for Svelte projects."><meta name="twitter:image" content="https://navillus.dev/assets/share.png"><meta name="twitter:url" content="https://navillus.dev/blog/introducing-svelte-entity-store/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="navillus_dev"><meta name="twitter:creator" content="navillus_dev"><link rel="sitemap" href="/sitemap.xml"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" href="/favicon.svg"><link rel="”mask-icon”" href="/favicon-mask.svg" color="#37322E"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><meta name="theme-color" content="#ffc331"><link rel="manifest" href="/manifest.json"><meta name="mobile-web-app-capable" content="yes"><meta name="application-name" content="Navillus"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Navillus"><style type="text/css">astro-root, astro-fragment { display: contents; }</style></head><!--!DOCTYPE--><body><astro-root uid="1RVRB4">

<header class="svelte-1mpqdiv"><a href="#start-of-content" class="sr-only sr-only-focusable svelte-1mpqdiv">Skip to content</a>
  <div class="container top svelte-1mpqdiv"><a href="/" class="brand svelte-1mpqdiv"><span class="sr-only svelte-1mpqdiv">Go to homepage</span>
      <svg viewBox="0 0 512 128" fill="none" xmlns="http://www.w3.org/2000/svg" class="svelte-1mpqdiv"><title class="svelte-1mpqdiv">Navillus</title><circle cx="64" cy="64" r="64" fill="var(--chisel-neutral-900)" class="svelte-1mpqdiv"></circle><rect x="44.1567" y="38.5" width="64" height="8" transform="rotate(45 44.1567 38.5)" fill="var(--chisel-primary)" class="svelte-1mpqdiv"></rect><rect x="38.5" y="83.7548" width="64" height="8" transform="rotate(-45 38.5 83.7548)" fill="var(--chisel-primary)" class="svelte-1mpqdiv"></rect><path d="M64 6.5L74.8253 25.25H53.1747L64 6.5Z" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></path><path d="M64 121.5L53.1747 102.75H74.8253L64 121.5Z" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></path><path d="M6.5 64L25.25 53.1747V74.8253L6.5 64Z" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></path><path d="M121.5 64L102.75 74.8253V53.1747L121.5 64Z" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></path><rect x="58" y="109" width="90" height="12" transform="rotate(-90 58 109)" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></rect><rect x="19" y="58" width="90" height="12" fill="var(--chisel-neutral-50)" class="svelte-1mpqdiv"></rect><path d="M222.457 96H214.267L181.327 46.05V96H173.137V33.18H181.327L214.267 83.04V33.18H222.457V96ZM233.358 71.16C233.358 66.12 234.378 61.71 236.418 57.93C238.458 54.09 241.248 51.12 244.788 49.02C248.388 46.92 252.378 45.87 256.758 45.87C261.078 45.87 264.828 46.8 268.008 48.66C271.188 50.52 273.558 52.86 275.118 55.68V46.68H283.398V96H275.118V86.82C273.498 89.7 271.068 92.1 267.828 94.02C264.648 95.88 260.928 96.81 256.668 96.81C252.288 96.81 248.328 95.73 244.788 93.57C241.248 91.41 238.458 88.38 236.418 84.48C234.378 80.58 233.358 76.14 233.358 71.16ZM275.118 71.25C275.118 67.53 274.368 64.29 272.868 61.53C271.368 58.77 269.328 56.67 266.748 55.23C264.228 53.73 261.438 52.98 258.378 52.98C255.318 52.98 252.528 53.7 250.008 55.14C247.488 56.58 245.478 58.68 243.978 61.44C242.478 64.2 241.728 67.44 241.728 71.16C241.728 74.94 242.478 78.24 243.978 81.06C245.478 83.82 247.488 85.95 250.008 87.45C252.528 88.89 255.318 89.61 258.378 89.61C261.438 89.61 264.228 88.89 266.748 87.45C269.328 85.95 271.368 83.82 272.868 81.06C274.368 78.24 275.118 74.97 275.118 71.25ZM315.599 88.44L330.899 46.68H339.629L320.279 96H310.739L291.389 46.68H300.209L315.599 88.44ZM351.918 38.67C350.358 38.67 349.038 38.13 347.958 37.05C346.878 35.97 346.338 34.65 346.338 33.09C346.338 31.53 346.878 30.21 347.958 29.13C349.038 28.05 350.358 27.51 351.918 27.51C353.418 27.51 354.678 28.05 355.698 29.13C356.778 30.21 357.318 31.53 357.318 33.09C357.318 34.65 356.778 35.97 355.698 37.05C354.678 38.13 353.418 38.67 351.918 38.67ZM355.878 46.68V96H347.688V46.68H355.878ZM378.026 29.4V96H369.836V29.4H378.026ZM400.175 29.4V96H391.985V29.4H400.175ZM457.873 46.68V96H449.683V88.71C448.123 91.23 445.933 93.21 443.113 94.65C440.353 96.03 437.293 96.72 433.933 96.72C430.093 96.72 426.643 95.94 423.583 94.38C420.523 92.76 418.093 90.36 416.293 87.18C414.553 84 413.683 80.13 413.683 75.57V46.68H421.783V74.49C421.783 79.35 423.013 83.1 425.473 85.74C427.933 88.32 431.293 89.61 435.553 89.61C439.933 89.61 443.383 88.26 445.903 85.56C448.423 82.86 449.683 78.93 449.683 73.77V46.68H457.873ZM489.161 96.81C485.381 96.81 481.991 96.18 478.991 94.92C475.991 93.6 473.621 91.8 471.881 89.52C470.141 87.18 469.181 84.51 469.001 81.51H477.461C477.701 83.97 478.841 85.98 480.881 87.54C482.981 89.1 485.711 89.88 489.071 89.88C492.191 89.88 494.651 89.19 496.451 87.81C498.251 86.43 499.151 84.69 499.151 82.59C499.151 80.43 498.191 78.84 496.271 77.82C494.351 76.74 491.381 75.69 487.361 74.67C483.701 73.71 480.701 72.75 478.361 71.79C476.081 70.77 474.101 69.3 472.421 67.38C470.801 65.4 469.991 62.82 469.991 59.64C469.991 57.12 470.741 54.81 472.241 52.71C473.741 50.61 475.871 48.96 478.631 47.76C481.391 46.5 484.541 45.87 488.081 45.87C493.541 45.87 497.951 47.25 501.311 50.01C504.671 52.77 506.471 56.55 506.711 61.35H498.521C498.341 58.77 497.291 56.7 495.371 55.14C493.511 53.58 490.991 52.8 487.811 52.8C484.871 52.8 482.531 53.43 480.791 54.69C479.051 55.95 478.181 57.6 478.181 59.64C478.181 61.26 478.691 62.61 479.711 63.69C480.791 64.71 482.111 65.55 483.671 66.21C485.291 66.81 487.511 67.5 490.331 68.28C493.871 69.24 496.751 70.2 498.971 71.16C501.191 72.06 503.081 73.44 504.641 75.3C506.261 77.16 507.101 79.59 507.161 82.59C507.161 85.29 506.411 87.72 504.911 89.88C503.411 92.04 501.281 93.75 498.521 95.01C495.821 96.21 492.701 96.81 489.161 96.81Z" fill="var(--chisel-neutral-900)" class="svelte-1mpqdiv"></path></svg></a>

    <nav class="svelte-1mpqdiv"><ul class="svelte-1mpqdiv"><li class="svelte-1mpqdiv"><a href="/" aria-current="false" class="svelte-1mpqdiv">Home</a>
          </li><li class="svelte-1mpqdiv"><a href="/#services" aria-current="false" class="svelte-1mpqdiv">Services</a>
          </li><li class="svelte-1mpqdiv"><a href="/blog" aria-current="false" class="svelte-1mpqdiv">Blog</a>
          </li></ul></nav>

    <a href="/#contact" class="button button--outline svelte-1mpqdiv">Get in Touch</a>

    <label for="toggle" title="Open Menu" class="hamburger hamburger--squeeze header__hamburger flex lg:hidden svelte-1mpqdiv"><span class="hamburger-box"><span class="hamburger-inner"></span></span></label></div>

  <input type="checkbox" id="toggle" class="sr-only svelte-1mpqdiv" title="Open Menu">

  <nav class="container svelte-1mpqdiv"><ul class="svelte-1mpqdiv"><li class="svelte-1mpqdiv"><a href="/" class="h5 svelte-1mpqdiv" aria-current="false">Home</a>
          </li><li class="svelte-1mpqdiv"><a href="/#services" class="h5 svelte-1mpqdiv" aria-current="false">Services</a>
          </li><li class="svelte-1mpqdiv"><a href="/blog" class="h5 svelte-1mpqdiv" aria-current="false">Blog</a>
          </li>
        <li class="svelte-1mpqdiv"><a href="/#contact" aria-current="false" class="button svelte-1mpqdiv">Get in Touch
          </a></li></ul></nav></header>

<div id="start-of-content" class="sr-only svelte-1mpqdiv"></div></astro-root>
<script type="module">
import setup from '/_astro_frontend/hydrate/idle.js';
setup("1RVRB4", async () => {
  const [{ default: Component }, { default: hydrate }] = await Promise.all([import("/_astro/src/components/Nav.svelte.js"), import("/_snowpack/pkg/@astrojs.renderer-svelte.client.v0.1.0.js")]);
  return (el, children) => hydrate(el)(Component, {
  "pathname": "/blog/introducing-svelte-entity-store"
}, children);
});
</script><main class="astro-olmHfk3M"><section class="alt astro-FyjNtDnF" id=""><div class="container astro-FyjNtDnF"><header class="astro-r7BMd6KB"><h1 class="astro-r7BMd6KB">Introducing svelte-entity-store</h1><small class="astro-r7BMd6KB">
                By
                <b class="astro-r7BMd6KB"><a href="https://tonysull.co" class="astro-r7BMd6KB">Tony Sullivan</a></b>
                •
                <time datetime="2021-05-01T00:00:00.000Z" class="astro-r7BMd6KB">Sat May 01 2021</time>
                • 4 min read
            </small><small class="astro-r7BMd6KB"><time datetime="2021-06-05T00:00:00.000Z" class="astro-r7BMd6KB"><i class="astro-r7BMd6KB">Updated: Sat Jun 05 2021</i></time></small></header>
<article class="astro-r7BMd6KB"><p class="astro-uM3zvQ96">A (<strong class="astro-uM3zvQ96">w</strong>ork-<strong class="astro-uM3zvQ96">i</strong>n-<strong class="astro-uM3zvQ96">p</strong>rogress) generic entity store for Svelte projects.</p><p class="astro-uM3zvQ96">Check out the <a href="https://github.com/tony-sull/svelte-entity-store/" class="astro-uM3zvQ96">repo</a> for details.</p><h2 id="why" class="astro-uM3zvQ96">Why?</h2><p class="astro-uM3zvQ96">This is ultimately just a <a href="https://svelte.dev/examples#custom-stores" class="astro-uM3zvQ96">custom store</a> built on top of <a href="https://svelte.dev/docs#svelte_store" class="astro-uM3zvQ96">svelte/store</a>. Like the rest of Svelte, the built in stores are excellent building blocks that aim to give you all the tools you need without trying to solve every single scenario out of the box.</p><p class="astro-uM3zvQ96">The goal with <code class="astro-uM3zvQ96">svelte-entity-store</code> is to provide a simple, generic solution for storing collections of entity objects. Throwing an array of items into a basic <code class="astro-uM3zvQ96">writable</code> store doesn't scale well if you have a lot of items and need to quickly find or update one item in the store.</p><h2 id="install" class="astro-uM3zvQ96">Install</h2><pre class="language-bash astro-y5UYZ7uS"><code class="language-bash astro-y5UYZ7uS"><span class="token function">npm</span> i -s svelte-entity-store
</code></pre><h2 id="usage" class="astro-uM3zvQ96">Usage</h2><blockquote class="astro-uM3zvQ96"><p class="astro-uM3zvQ96">Check out <a href="https://github.com/tony-sull/svelte-entity-store/tree/main/examples/todomvc" class="astro-uM3zvQ96">/examples</a> for a working TodoMVC demo based on SvelteKit. More to come!</p></blockquote><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> entityStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte-entity-store'</span>

  <span class="token comment">// Define your entity interface</span>
  <span class="token class-name"><span class="token keyword">interface</span></span> TodoItem <span class="token punctuation">{</span>
    id<span class="token operator">:</span> <span class="token builtin">string</span>
    description<span class="token operator">:</span> <span class="token builtin">string</span>
    completed<span class="token operator">:</span> <span class="token builtin">boolean</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Write a getter function that returns the ID of an entity (can be inlined in the constructor also)</span>
  <span class="token comment">// Currently number and string values are valid IDs</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token punctuation">(</span>todo<span class="token operator">:</span> TodoItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>id

  <span class="token comment">// Initialize the store</span>
  <span class="token comment">// (optional) the constructor accepts an Array as a second param</span>
  <span class="token comment">//            ex: if you rehydrate state from localstorage</span>
  <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token generic-function"><span class="token function">entityStore</span><span class="token generic class-name"><span class="token operator">&lt;</span>TodoItem<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>getId<span class="token punctuation">)</span>

  <span class="token comment">// Get a derived store for every active todo</span>
  <span class="token keyword">const</span> activeTodos <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span>

  <span class="token comment">// toggle a todo</span>
  <span class="token keyword">function</span> <span class="token function">toggle</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>todo<span class="token punctuation">,</span> completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// clear completed todos</span>
  <span class="token keyword">function</span> <span class="token function">clearCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    store<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token punctuation">{</span>#each $activeTodos <span class="token keyword">as</span> <span class="token function">todo</span> <span class="token punctuation">(</span>todo<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token comment">// ... render your UI as usual</span>
<span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span>
</code></pre><h3 id="creating-the-store" class="astro-uM3zvQ96">Creating the Store</h3><p class="astro-uM3zvQ96">Creating an instance of the store is pretty straight forward. Svelte has excellent <a href="https://svelte.dev/blog/svelte-and-typescript" class="astro-uM3zvQ96">TypeScript support</a> these days, but it isn't a must. Using <code class="astro-uM3zvQ96">svelte-entity-store</code> in plain old JavaScript is very similar, just skip the <code class="astro-uM3zvQ96">interface</code> definition and <code class="astro-uM3zvQ96">&lt;Type&gt;</code> casting.</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token keyword">import</span> <span class="token punctuation">{</span> entityStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"svelte-entity-store"</span><span class="token punctuation">;</span>

<span class="token comment">// Define your entity interface</span>
<span class="token class-name"><span class="token keyword">interface</span></span> TodoItem <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  completed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Write a getter function that returns the ID of an entity (can be inlined in the constructor also)</span>
<span class="token comment">// Currently number and string values are valid IDs</span>
<span class="token keyword">const</span> <span class="token function-variable function">getId</span> <span class="token operator">=</span> <span class="token punctuation">(</span>todo<span class="token operator">:</span> TodoItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>id<span class="token punctuation">;</span>

<span class="token comment">// Initialize the store</span>
<span class="token comment">// (optional) the constructor accepts an Array as a second param</span>
<span class="token comment">//            ex: if you rehydrate state from localstorage</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token generic-function"><span class="token function">entityStore</span><span class="token generic class-name"><span class="token operator">&lt;</span>TodoItem<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>getId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p class="astro-uM3zvQ96">Nothing to crazy there so far. For TypeScript we define the model <code class="astro-uM3zvQ96">interface</code>, you could also use <code class="astro-uM3zvQ96">type</code> if that's your thing. The store also needs to know how to get unique IDs for each item. Right now <code class="astro-uM3zvQ96">string</code> and <code class="astro-uM3zvQ96">number</code> IDs are supported, but this may be extended later.</p><h4 id="need-initial-state" class="astro-uM3zvQ96">Need initial state?</h4><p class="astro-uM3zvQ96">No problem! The store accepts an optional second parameter.</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token keyword">const</span> items <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token comment">// ... array of TodoItem's to populate the store with</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token generic-function"><span class="token function">entityStore</span><span class="token generic class-name"><span class="token operator">&lt;</span>TodoItem<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>getId<span class="token punctuation">,</span> items<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p class="astro-uM3zvQ96">Pass in an array of initial items to avoid having to call <code class="astro-uM3zvQ96">store.set(items)</code> immediately. This is particularly handy if you are rehydrating the store from cache or localstorage, similar to the <a href="https://github.com/tony-sull/svelte-entity-store/tree/main/examples/todomvc" class="astro-uM3zvQ96">TodoMVC example</a>.</p><h3 id="subscribing-to-entities" class="astro-uM3zvQ96">Subscribing to entities</h3><p class="astro-uM3zvQ96">The store's <code class="astro-uM3zvQ96">get()</code> methods return <a href="https://svelte.dev/docs#readable" class="astro-uM3zvQ96">readable stores</a> to access the entities. The <code class="astro-uM3zvQ96">get()</code> method has multiple overrides to serve different uses like grabbing a single entity, filtered list of entities, or everything in the store.</p><p class="astro-uM3zvQ96">Properly overriding methods in TypeScript was an interesting challenge to get autocorrect and similar tooling to work properly. It's too much to go into here but should turn into a blog post of its own soon.</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token comment">// Get one entity by ID</span>
<span class="token keyword">const</span> item <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"abc-123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get a list of entities by ID</span>
<span class="token keyword">const</span> items <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get a list of entities that match a filter function</span>
<span class="token keyword">const</span> activeItems <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Or get every entity in the store</span>
<span class="token keyword">const</span> allItems <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p class="astro-uM3zvQ96">Because the store is returning <a href="https://svelte.dev/docs#derived" class="astro-uM3zvQ96">derived stores</a>, the full power of Svelte's <a href="https://svelte.dev/docs#4_Prefix_stores_with_$_to_access_their_values" class="astro-uM3zvQ96">reactivity</a> model just works.</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">&gt;</span>
  <span class="token comment">// Create a computed property based on the get() results</span>
  $<span class="token operator">:</span> activeItemsCount <span class="token operator">=</span> $activeItems<span class="token punctuation">.</span>count
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">// Directly access a single entity</span>
<span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token punctuation">{</span>$item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>

<span class="token comment">// Or loop over multiple entities</span>
<span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span>#each $allItems <span class="token keyword">as</span> <span class="token function">item</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">:</span>completed<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>completed<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
</code></pre><h3 id="updating-the-store" class="astro-uM3zvQ96">Updating the store</h3><p class="astro-uM3zvQ96">Much like <code class="astro-uM3zvQ96">get()</code>, <code class="astro-uM3zvQ96">set()</code> has a few different overrides. Calling <code class="astro-uM3zvQ96">set</code> will blow away any old entity state, if you need to keep some of the old entities' state check out <code class="astro-uM3zvQ96">update()</code> instead (below).</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token comment">// Replace the existing entity with ID 123, or add it if the ID doesn't exist yet</span>
store<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">"Todo #1"</span><span class="token punctuation">,</span>
  completed<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Or add/replace multiple todos at once</span>
store<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">// ... multiple todo objects</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p class="astro-uM3zvQ96">Sometimes you just need to change part of an entity without worrying about the entire object. <code class="astro-uM3zvQ96">update()</code> solves this, it should look very <a href="https://svelte.dev/docs#writable" class="astro-uM3zvQ96">familiar</a>.</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token keyword">function</span> <span class="token function">toggleTodo</span><span class="token punctuation">(</span>todo<span class="token operator">:</span> TodoItem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>todo<span class="token punctuation">,</span>
    completed<span class="token operator">:</span> <span class="token operator">!</span>todo<span class="token punctuation">.</span>completed<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Update a single entity by ID</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// In case you already have the entity object and don't want to call getId,</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">,</span> todoObj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// The same goes for lists of IDs or entities</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">,</span> $activeTodos<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// What if you want to only update entities that meet a filter condition?</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">,</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Go crazy with it and run the update against every entity in the store</span>
store<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>toggleTodo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h3 id="removing-entities" class="astro-uM3zvQ96">Removing entities</h3><p class="astro-uM3zvQ96">Removing will look very similar to <code class="astro-uM3zvQ96">update()</code></p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token comment">// You can remove single entities by ID</span>
store<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>

<span class="token comment">// By list of IDs</span>
store<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// Or remove every item that matches a filter</span>
<span class="token keyword">const</span> <span class="token function-variable function">isCompleted</span> <span class="token operator">=</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> todo<span class="token punctuation">.</span>completed<span class="token punctuation">)</span>
store<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>isCompleted<span class="token punctuation">)</span>
</code></pre><p class="astro-uM3zvQ96">Writing the examples here for <code class="astro-uM3zvQ96">update</code> and <code class="astro-uM3zvQ96">remove</code>, I realized there's no reason that <code class="astro-uM3zvQ96">remove</code> shouldn't let you pass in the entity objects similar to <code class="astro-uM3zvQ96">update</code>. Time for a <a href="https://github.com/tony-sull/svelte-entity-store/issues/1" class="astro-uM3zvQ96">github issue</a>.</p><h2 id="fully-tested" class="astro-uM3zvQ96">Fully tested</h2><p class="astro-uM3zvQ96">I went a little overboard trying out a few new (to me) CI and testing tools. On the plus side, the <code class="astro-uM3zvQ96">v1.0.0</code> of store has 100% test coverage and a working <a href="https://github.com/tony-sull/svelte-entity-store/tree/main/examples/todomvc" class="astro-uM3zvQ96">TodoMVC example</a>.</p><p class="astro-uM3zvQ96">All testing is done with <a href="https://github.com/lukeed/" class="astro-uM3zvQ96">lukeed</a>'s excellent <a href="https://github.com/lukeed/uvu" class="astro-uM3zvQ96">uvu</a> test framework. I've mostly reached for <a href="https://jestjs.io/" class="astro-uM3zvQ96">Jest</a> the last few years but I don't think I'll be turning back. <code class="astro-uM3zvQ96">uvu</code> was simple to setup and it really does fly compared to other testing frameworks.</p><p class="astro-uM3zvQ96">Take a peek at some of the <code class="astro-uM3zvQ96">svelte-entity-store</code><a href="https://github.com/tony-sull/svelte-entity-store/tree/main/tests" class="astro-uM3zvQ96">tests</a>. It was particularly interesting figuring out a clean way to store subscriptions, i.e. to make sure subscribers get updated state or that subscribers aren't called if an API call didn't actually change the store at all.</p><h2 id="missing-features" class="astro-uM3zvQ96">Missing features</h2><p class="astro-uM3zvQ96">I purposely didn't add sorting support for v1.0. It can be done without too much headache...</p><pre class="language-ts astro-y5UYZ7uS"><code class="language-ts astro-y5UYZ7uS"><span class="token keyword">const</span> allItems <span class="token operator">=</span> store<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$sortedItems <span class="token operator">=</span> $allItems<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>a <span class="token operator">&lt;</span> b <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p class="astro-uM3zvQ96">but ideally that's built right into the store itself. There's an <a href="https://github.com/tony-sull/svelte-entity-store/issues/2" class="astro-uM3zvQ96">issue</a> tracking sorting functionality, the best solution is probably to add an optional <code class="astro-uM3zvQ96">sort</code> parameter to all <code class="astro-uM3zvQ96">get()</code> overloads.</p><h3 id="what-else" class="astro-uM3zvQ96">What else?</h3><p class="astro-uM3zvQ96">What'd I miss? File <a href="https://github.com/tony-sull/svelte-entity-store/issues" class="astro-uM3zvQ96">issues</a> for feature requests!</p></article></div></section></main><footer class="astro-n31rkg6Y"><div class="container astro-n31rkg6Y"><ul class="social astro-n31rkg6Y"><li class="astro-n31rkg6Y"><a href="mailto:info@navillus.nl" class="astro-n31rkg6Y"><span class="sr-only astro-n31rkg6Y">Email us at info@navillus.nl</span><svg class="astro-n31rkg6Y"><use xlink:href="/assets/contact-sprites.svg#email" class="astro-n31rkg6Y"></use></svg></a></li><li class="astro-n31rkg6Y"><a href="https://twitter.com/navillus_dev" class="astro-n31rkg6Y"><span class="sr-only astro-n31rkg6Y">Find us on Twitter</span><svg class="astro-n31rkg6Y"><use xlink:href="/assets/contact-sprites.svg#twitter" class="astro-n31rkg6Y"></use></svg></a></li></ul><ul class="links astro-n31rkg6Y"><li class="astro-n31rkg6Y"><a class="h6 astro-n31rkg6Y" href="/privacy">Privacy Policy</a></li><li class="astro-n31rkg6Y"><a class="h6 astro-n31rkg6Y" href="/terms">Terms &amp; Conditions</a></li><li class="astro-n31rkg6Y"><a class="h6 astro-n31rkg6Y" href="/#contact">Contact Us</a></li></ul><div class="legal astro-n31rkg6Y"><div class="astro-n31rkg6Y">© 2021 Navillus B.V.</div><small class="astro-n31rkg6Y">
				Icons made by
				<a href="https://www.freepik.com" class="underline astro-n31rkg6Y" title="Freepik">Freepik</a>
				from
				<a href="https://www.flaticon.com/" class="underline astro-n31rkg6Y" title="Flaticon">
					www.flaticon.com
				</a></small></div></div></footer></body></html>